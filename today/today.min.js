let gameAccessor=function(){"use strict";let t={canvasId:"game-canvas",wrapperId:"canvas-wrapper",containerId:"game-container",resizeDelay:250,canvasPosition:"center center",stretchToFit:!1,fillScreen:!0,scaleByDPR:!1,orientation:"both",gameFieldWidth:1920,gameFieldHeight:1080},e=function(){if(!t)return console.log("ERROR: unable to load config.js"),null;let e,n,i,r,o,s,a,u,h,l,d,c,p,g,f,m=!1,y=[],v=0;function b(){const m=window.devicePixelRatio||1;let b,w;for(l&&(o=parseFloat(window.getComputedStyle(h).getPropertyValue("padding-left")),s=parseFloat(window.getComputedStyle(h).getPropertyValue("padding-right")),a=parseFloat(window.getComputedStyle(h).getPropertyValue("padding-top")),u=parseFloat(window.getComputedStyle(h).getPropertyValue("padding-bottom")),i=h.clientHeight-(a+u),r=h.clientWidth-(o+s),f="both"===t.orientation?window.innerWidth>=window.innerHeight?"landscape":"portrait":t.orientation,t.stretchToFit?(c=i,p=r):"portrait"===f?(g="fitWidth",b=t.gameFieldWidth/t.gameFieldHeight,c=i,p=c*b,!t.fillScreen&&Math.floor(p)>r&&(g="fitHeight",b=t.gameFieldHeight/t.gameFieldWidth,p=r,c=p*b)):(g="fitHeight",b=t.gameFieldHeight/t.gameFieldWidth,p=r,c=p*b,!t.fillScreen&&Math.floor(c)>i&&(g="fitWidth",b=t.gameFieldWidth/t.gameFieldHeight,c=i,p=c*b)),t.scaleByDPR&&(l.width=Math.round(t.gameFieldWidth*m),l.height=Math.round(t.gameFieldHeight*m),n.scale(m,m)),d.style.width=Math.round(p)+"px",d.style.height=Math.round(c)+"px",function(){let e,n,l,g,f=t.canvasPosition.split(" ");"absolute"===window.getComputedStyle(h).getPropertyValue("position")?(e=document.body.getBoundingClientRect(),n=h.getBoundingClientRect(),l=n.left-e.left,g=n.top-e.top):(l=0,g=0);switch(f[0]){default:case"center":d.style.top=Math.round(g+a+(i/2-c/2))+"px";break;case"top":d.style.top=Math.round(g+a)+"px";break;case"bottom":d.style.top=Math.round(g+h.clientHeight-c-u)+"px"}switch(f[1]){default:case"center":d.style.left=Math.round(l+o+(r/2-p/2))+"px";break;case"left":d.style.left=Math.round(l+o)+"px";break;case"right":d.style.left=Math.round(l+h.clientWidth-p-s)+"px"}}(),e=l.getBoundingClientRect()),w=0;w<v;w++)y[w]()}return{init:function(){m?console.log("ERROR: resizer already initialized."):(m=!0,h=document.getElementById(t.containerId),""!==t.canvasId&&(l=document.getElementById(t.canvasId),n=l.getContext("2d"),p=t.gameFieldWidth,c=t.gameFieldHeight,l.width=p,l.height=c,""!==t.wrapperId?(d=document.getElementById(t.wrapperId),l.style.width="100%",l.style.height="100%"):d=l,d.style.position="absolute"),t.resizeDelay>0?window.addEventListener("resize",function(t,e,n){let i;return function(){let r=this,o=arguments,s=n&&!i;clearTimeout(i),i=window.setTimeout((function(){i=null,n||t.apply(r,o)}),e),s&&t.apply(r,o)}}(b,t.resizeDelay,!1),!1):window.addEventListener("resize",b,!1),b())},resize:b,getOrientation:function(){return f},getSizeMode:function(){return g},getCanvas:function(){return l||(console.log("ERROR: canvas has been set to false in config.js"),null)},getContainer:function(){return h},getGameHeight:function(){return t.gameFieldHeight},getGameWidth:function(){return t.gameFieldWidth},getCanvasWidth:function(){return p},getCanvasHeight:function(){return c},getCanvasBoundingRect:function(){return e},addResizeEvent:function(t){y.push(t),v++},removeResizeEvent:function(t){let e=0;for(;y[e]!==t&&e<v;)e++;e<v&&(y[e]=y[y.length-1],y[y.length-1]=void 0,y.length=y.length-1)},getRelativeEventCoords:function(e){let n=p/t.gameFieldWidth;return{x:(e.pageX-function(t){let e=0;do{isNaN(t.offsetLeft)||(e+=t.offsetLeft),t=t.offsetParent}while(null!==t);return e}(l))/n,y:(e.pageY-function(t){let e=0;do{isNaN(t.offsetTop)||(e+=t.offsetTop),t=t.offsetParent}while(null!==t);return e}(l))/n}}}}();e.init();const n=e.getGameHeight(),i=e.getGameWidth(),r={DAY:0,DUSK:1,NIGHT:2,DAWN:3},o=Object.keys(r).length,s=.01;let a=r.DAY;function u(t,e,n){return Math.min(Math.max(t,e),n)}function h(t,e){e>=t.length?console.error("ERROR: mutableRemoveIndex: index is out of range"):t.length<=0?console.error("ERROR: mutableRemoveIndex: empty array"):(t[e]=t[t.length-1],t.pop())}function l(t){this.template=t,this.pool=[]}function d(t,e,n,i){this.x=t,this.y=e,this.width=n,this.height=i}function c(t,e,n,i,r){this.width=e,this.height=n,this.frames=i,this.frameRate=r,this.timer=0,this.currentFrame=0,this.image=t,this.animationEndEvent=null,this.layers=[],this.draw=!0,this.foreground=!1,this.alpha=1,this.fadeAmt=0}function p(t,e,n,i,r){this.x=t,this.y=e,this.xFraction=0,this.yFraction=0,this.time=0,this.width=n,this.height=i,this.sprite=r,this.hitbox=new d(this.x-this.width/2,this.y-this.height/2,this.width,this.height)}l.prototype.take=function(){let t,e,n=this.pool.length,i=null;for(e=0;e<n;e++)if(i=this.pool[e],i.available)return i.available=!1,i.object.init(),i.object;return t=this.template.clone(),t.init(),this.pool.push({available:!1,object:t}),t},l.prototype.putBack=function(t){let e,n,i=this.pool.length;for(n=0;n<i;n++)if(e=this.pool[n],e.object===t)return void(e.available=!0)},d.prototype.left=function(){return this.x},d.prototype.right=function(){return this.x+this.width},d.prototype.top=function(){return this.y},d.prototype.bottom=function(){return this.y+this.height},d.prototype.intersects=function(t){return this.right()>=t.left()&&this.left()<=t.right()&&this.top()<=t.bottom()&&this.bottom()>=t.top()},d.prototype.contains=function(t,e){return this.left()<=t&&t<=this.right()&&this.bottom()<=e&&e<=this.top()},d.prototype.union=function(t){let e,n,i,r;if(void 0!==t)return e=Math.min(this.x,t.x),n=Math.min(this.y,t.y),i=Math.max(this.right(),t.right())-Math.min(this.left(),t.left()),r=Math.max(this.bottom(),t.bottom())-Math.min(this.top(),t.top()),this.x=e,this.y=n,this.width=i,this.height=r,this},d.prototype.intersection=function(t){let e,n,i,r;return e=Math.max(this.left(),t.left()),r=Math.min(this.bottom(),t.bottom()),n=Math.min(this.right(),t.right()),i=Math.max(this.top(),t.top()),e>n||r<i?(this.x=-1,this.y=-1,this.width=0,this.height=0):(this.x=e,this.y=i,this.width=n-e,this.height=r-i),this},d.prototype.getArea=function(){return this.height*this.width},c.prototype.eventDriven=function(t,e,n,i,r,o,s,a,u,h){let l=document.createElement("img"),d=document.createElement("img");return l.addEventListener("load",(function t(){let s=document.createElement("canvas"),c=s.getContext("2d");s.width=e*o,s.height=n,c.drawImage(l,u*i,a*r,i*o,r,0,0,e*o,n),h&&(c.globalAlpha=.25,c.globalCompositeOperation="source-atop",c.fillStyle=h,c.fillRect(0,0,e*o,n)),s.toBlob((t=>{d.src=URL.createObjectURL(t),d.onload=()=>{URL.revokeObjectURL(d.src)}})),l.removeEventListener("load",t)}),!1),l.src=t,this.width=e,this.height=n,this.frames=o,this.frameRate=s,this.image=d,this},c.prototype.tiled=function(t,e,n,i,r,o,s,a,u){let h=document.createElement("img"),l=document.createElement("img");return h.addEventListener("load",(function t(){let d,c,p=document.createElement("canvas"),g=p.getContext("2d");for(p.width=e,p.height=n,d=0;d<a;d++)for(c=0;c<u;c++)g.drawImage(h,s*i,o*r,i,r,d*e/a,c*n/u,e/a,n/u);p.toBlob((t=>{l.src=URL.createObjectURL(t),l.onload=()=>{URL.revokeObjectURL(l.src)}})),h.removeEventListener("load",t)}),!1),h.src=t,this.width=e,this.height=n,this.frameRate=0,this.frames=1,this.image=l,this},c.prototype.resetAnimation=function(){this.currentFrame=0},c.prototype.update=function(t){let e;for(this.alpha=u(this.alpha+this.fadeAmt,0,1),e=0;e<this.layers.length;e++)this.layers[e].update(t);this.frameRate>0&&(this.timer+=t,this.timer>1/this.frameRate&&(this.timer=0,this.currentFrame++,this.currentFrame>this.frames-1&&null!==this.animationEndEvent&&this.animationEndEvent()))},c.prototype.init=function(){this.width=0,this.height=0,this.frameRate=0,this.frames=0,this.currentFrame=0,this.timer=0,this.alpha=1,this.fadeAmt=0,this.layers.length=0,this.image=null,this.animationEndEvent=null,this.draw=!0,this.foreground=!1},c.prototype.clone=function(){return new c(this.image,this.width,this.height,this.frames,this.frameRate)},c.prototype.copyAttributes=function(t){return this.width=t.width,this.height=t.height,this.frameRate=t.frameRate,this.frames=t.frames,this.image=t.image,this.animationEndEvent=t.animationEndEvent,this.draw=t.draw,this.alpha=t.alpha,this.fadeAmt=t.fadeAmt,this.foreground=t.foreground,this},c.prototype.addLayer=function(t){this.layers.push(t)},p.prototype.init=function(){this.x=0,this.y=0,this.xFraction=0,this.yFraction=0,this.time=0,this.sprite=null},p.prototype.clone=function(){return new p(this.x,this.y,this.width,this.height,this.sprite)},p.prototype.update=function(t){let e=this.x,n=this.y,i=this.xFraction,r=this.yFraction;this.time+=t,e+=i,n+=r,i=e%1,r=n%1,e-=i,n-=r,this.x=e,this.y=n,this.xFraction=i,this.yFraction=r},p.prototype.collisionRect=function(){return this.hitbox.x=this.x,this.hitbox.y=this.y,this.hitbox.width=this.width,this.hitbox.height=this.height,this.hitbox},p.prototype.isCollidingWith=function(t){let e=this.collisionRect(),n=t.collisionRect();return e.intersects(n)};let g=function(){const t=1920,e=1080,r="sprites/";let o,s,a,u,h,d,p,g=new l(new c(null,0,0,0,0)),f=g.take().eventDriven(r+"balloon.png",295,470,1180,1880,1,0,0,0),m=g.take().eventDriven(r+"dunes1.png",t,e,i,n,1,0,0,0),y=g.take().eventDriven(r+"dunes2.png",t,e,i,n,1,0,0,0),v=g.take().eventDriven(r+"dunes3.png",t,e,i,n,1,0,0,0),b=g.take().eventDriven(r+"dunes4.png",t,e,i,n,1,0,0,0),w=g.take().eventDriven(r+"day_fg.png",t,e,i,n,1,0,0,0),k=g.take().eventDriven(r+"day_bg.png",t,e,i,n,1,0,0,0),D=g.take().eventDriven(r+"day_sky.png",t,e,i,n,1,0,0,0),A=g.take().eventDriven(r+"balloon.png",295,470,1180,1880,1,0,0,0,"#f56342"),_=g.take().eventDriven(r+"dunes1.png",t,e,i,n,1,0,0,0,"red"),x=g.take().eventDriven(r+"dunes2.png",t,e,i,n,1,0,0,0,"red"),R=g.take().eventDriven(r+"dunes3.png",t,e,i,n,1,0,0,0,"red"),E=g.take().eventDriven(r+"dunes4.png",t,e,i,n,1,0,0,0,"red"),F=g.take().eventDriven(r+"dawndusk_fg.png",t,e,i,n,1,0,0,0),L=g.take().eventDriven(r+"dawndusk_bg.png",t,e,i,n,1,0,0,0),S=g.take().eventDriven(r+"dawndusk_sky.png",t,e,i,n,1,0,0,0),C=g.take().eventDriven(r+"balloon.png",295,470,1180,1880,1,0,0,0,"#6e7fe0"),M=g.take().eventDriven(r+"dunes1.png",t,e,i,n,1,0,0,0,"blue"),I=g.take().eventDriven(r+"dunes2.png",t,e,i,n,1,0,0,0,"blue"),W=g.take().eventDriven(r+"dunes3.png",t,e,i,n,1,0,0,0,"blue"),B=g.take().eventDriven(r+"dunes4.png",t,e,i,n,1,0,0,0,"blue"),H=g.take().eventDriven(r+"night_fg.png",t,e,i,n,1,0,0,0),N=g.take().eventDriven(r+"night_bg.png",t,e,i,n,1,0,0,0),O=g.take().eventDriven(r+"night_sky.png",t,e,i,n,1,0,0,0);function P(t){if(u=t,a.gain.value=.15*t,s.gain.value=.1*t,"undefined"!=typeof Storage)try{localStorage.setItem("yao_masterVolume",JSON.stringify(u))}catch(t){console.log("Error: an issue occurred when saving volume data.")}}return o=new(window.AudioContext||window.webkitAudioContext),u=1,h=.1,d=.15,s=o.createGain(),s.gain.value=.1,a=o.createGain(),a.gain.value=.15,{spr_sky:function(){return g.take().copyAttributes(D)},spr_dunes1:function(){return g.take().copyAttributes(m)},spr_dunes2:function(){return g.take().copyAttributes(y)},spr_dunes3:function(){return g.take().copyAttributes(v)},spr_dunes4:function(){return g.take().copyAttributes(b)},spr_cloudsfg:function(){return g.take().copyAttributes(w)},spr_cloudsbg:function(){return g.take().copyAttributes(k)},spr_balloon:function(){return g.take().copyAttributes(f)},spr_redSky:function(){return g.take().copyAttributes(S)},spr_redDunes1:function(){return g.take().copyAttributes(_)},spr_redDunes2:function(){return g.take().copyAttributes(x)},spr_redDunes3:function(){return g.take().copyAttributes(R)},spr_redDunes4:function(){return g.take().copyAttributes(E)},spr_redCloudsfg:function(){return g.take().copyAttributes(F)},spr_redCloudsbg:function(){return g.take().copyAttributes(L)},spr_redBalloon:function(){return g.take().copyAttributes(A)},spr_blueSky:function(){return g.take().copyAttributes(O)},spr_blueDunes1:function(){return g.take().copyAttributes(M)},spr_blueDunes2:function(){return g.take().copyAttributes(I)},spr_blueDunes3:function(){return g.take().copyAttributes(W)},spr_blueDunes4:function(){return g.take().copyAttributes(B)},spr_blueCloudsfg:function(){return g.take().copyAttributes(H)},spr_blueCloudsbg:function(){return g.take().copyAttributes(N)},spr_blueBalloon:function(){return g.take().copyAttributes(C)},initVolume:function(){let t;if("undefined"!=typeof Storage){try{t=JSON.parse(localStorage.getItem("yao_masterVolume"))}catch(t){console.log("Previous volume data is corrupted or missing.")}if(t||0===t)return u=t,this.setMasterVolume(t),t}return null},setMasterVolume:P,mute:function(){p=u,P(0)},unmute:function(){P(p)},putSpriteBack:function(t){let e;for(e=t.layers.length;e>=0;e--)g.putBack(t.layers[e]);g.putBack(t)}}}(),f=function(){let t=e.getCanvas(),n=t.getContext("2d",{alpha:!1}),o=[];function u(t,e,i){let r,o=t.layers,s=t;for(r=0;r<=o.length;r++)t=o[r],r===o.length&&(t=s),t.draw&&(t.frameRate<=0||t.currentFrame>=t.frames)?(n.save(),n.globalAlpha=t.alpha,n.drawImage(t.image,t.width*(t.frames-1),0,t.width,t.height,e,i,t.width,t.height),n.restore()):t.draw&&(n.save(),n.globalAlpha=t.alpha,n.drawImage(t.image,t.width*t.currentFrame,0,t.width,t.height,e,i,t.width,t.height),n.restore())}let h=function(){let t=g.spr_sky(),e=g.spr_dunes1(),n=g.spr_dunes2(),o=g.spr_dunes3(),h=g.spr_dunes4(),l=g.spr_cloudsfg(),d=g.spr_cloudsbg(),c=g.spr_redSky(),p=g.spr_redDunes1(),f=g.spr_redDunes2(),y=g.spr_redDunes3(),v=g.spr_redDunes4(),b=g.spr_redCloudsfg(),w=g.spr_redCloudsbg(),k=g.spr_blueSky(),D=g.spr_blueDunes1(),A=g.spr_blueDunes2(),_=g.spr_blueDunes3(),x=g.spr_blueDunes4(),R=g.spr_blueCloudsfg(),E=g.spr_blueCloudsbg(),F=[d,l,h,o,n,e],L=[w,b,v,y,f,p],S=[E,R,x,_,A,D],C=[.1,.2,.25,.35,.6,1],M=new Array(F.length).fill(0);for(let t=0;t<F.length;t++)L[t].alpha=0,S[t].alpha=0;c.alpha=0,k.alpha=0;let I,W,B=a;return function(){if(B!==a){I.fadeAmt=-.01;for(const t of W)t.fadeAmt=-.01}switch(a){case r.DAY:I=t,W=F;break;case r.DUSK:I=c,W=L;break;case r.NIGHT:I=k,W=S;break;case r.DAWN:I=c,W=L}if(B!==a){B=a,I.fadeAmt=s;for(const t of W)t.fadeAmt=.04}t.update(),k.update(),c.update(),u(t,0,0),u(k,0,0),u(c,0,0);let e=0;for(let t=0;t<F.length;t++){let n=Math.round(M[t]);F[t].update(),L[t].update(),S[t].update(),u(F[t],n+i,0),u(F[t],n,0),u(L[t],n+i,0),u(L[t],n,0),u(S[t],n+i,0),u(S[t],n,0),e=C[t],m.accelerating()&&(M[t]=(M[t]-1.5*e)%i)}}}();return{render:function(t){let e,n,i,r=m.entities();if(h(),r){for(i=r.length,n=0;n<i;n++)e=r[n],e.sprite&&((m.accelerating()||0!==e.sprite.fadeAmt)&&e.sprite.update(t),e.sprite.foreground?o.push(e):u(e.sprite,e.x,e.y));for(n=0;n<o.length;n++)e=o[n],u(e.sprite,e.x,e.y);o.length=0}},canvas:t}}(),m=function(){let t,e,s,l,d,c,m,y=!1,v=.001,b=v,w=b;const k=g.spr_balloon(),D=g.spr_redBalloon(),A=g.spr_blueBalloon(),_=new Array(o);function x(e){t.push(e)}return _[r.DAY]=k,_[r.DUSK]=D,_[r.NIGHT]=A,_[r.DAWN]=D,{start:function(){t&&function(e){let n,i=e.length;if(0===i)return;for(n=i-1;n>=0;n--){let i,r=e[n];null!==r.sprite&&g.putSpriteBack(r.sprite),i=t.indexOf(r),i>=0&&h(t,i)}}(t),t=[],s=!0,e=0;const r=Math.round(i/2-k.width/2),o=Math.round(n/2-k.height/2);let u=_[a];d=new p(r,o,u.width,u.height,u),c=d.x,m=d.y,x(d),y||(y=!0,l=this.update.bind(this),window.requestAnimationFrame(l))},update:function(n){let i,r,o=t.length,h=Math.min((n-e)/1e3,.05);for(e=n,r=0;r<o;r++)i=t[r],s&&(i.update(h),d.sprite=_[a],w+=b,w=u(w,-.1,.1),d.y+=w,d.y>=m+60?b=-.001:d.y<=m-60&&(b=v));f.render(h),window.requestAnimationFrame(l)},toggleAcceleration:function(){s=!s},addEntity:x,accelerating:function(){return s},started:function(){return y},entities:function(){return t}}}();const y=(()=>{const t=document.querySelectorAll("#poem-modal p"),e=[r.DAY,r.DAY,r.DUSK,r.DUSK,r.NIGHT,r.NIGHT,r.DAWN,r.DAWN];let n=-1;return function(){n>=0&&t[n].classList.remove("show"),n=(n+1)%t.length,t[n].classList.add("show"),a=e[n]}})();document.body.addEventListener("touchmove",(function(t){t.preventDefault()}),{passive:!1}),window.addEventListener("load",(()=>{window.setTimeout((()=>{const t=document.getElementById("next-btn"),e=t.querySelector("div"),n=document.querySelector("#loader"),i=document.querySelector("#canvas-wrapper"),r=document.querySelector("#game-canvas"),o=document.querySelector("#poem-modal p");t.addEventListener("animationend",(()=>{e.classList.remove("bounce-animation")})),t.addEventListener("click",(()=>{y(),e.classList.add("bounce-animation")})),n.classList.add("loaded"),n.addEventListener("animationend",(function e(){n.removeEventListener("animationend",e),i.classList.remove("loading"),y(),o.addEventListener("transitionend",(function t(){o.removeEventListener("transitionend",t),i.classList.add("loaded")})),r.addEventListener("transitionend",(function e(){r.removeEventListener("transitionend",e),t.classList.remove("loading")})),m.start()}))}),3e3)}),!1)}();